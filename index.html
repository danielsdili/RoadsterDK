<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <title>ROADSTER - Burnout Night Edition</title>

  <style>
    body {
      margin: 0;
      background: radial-gradient(circle at top, #111, #000);
      font-family: Arial, sans-serif;
      overflow: hidden;
      color: white;
      touch-action: none;
    }

    #hud {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      font-weight: bold;
      padding: 10px 14px;
      box-sizing: border-box;
      opacity: 0.95;
      gap: 10px;
      align-items: center;
    }

    #hudLeft, #hudRight {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    #nitroBarWrap {
      width: 140px;
      height: 12px;
      border: 2px solid gold;
      border-radius: 8px;
      overflow: hidden;
      background: rgba(0,0,0,0.6);
      box-shadow: 0 0 10px rgba(255,215,0,0.2);
    }

    #nitroBar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #00b7ff, #00fff2, #ffffff);
      transition: width 0.08s linear;
    }

    #shieldStatus {
      font-size: 13px;
      color: #66ccff;
      text-shadow: 0 0 10px rgba(0,200,255,0.4);
    }

    #wrap {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      position: relative;
    }

    canvas {
      width: 100%;
      height: 75vh;
      border: 4px solid #444;
      border-radius: 14px;
      background: linear-gradient(#1a1a1a, #0b0b0b);
      display: block;
      box-shadow: 0 0 20px rgba(255,255,255,0.08);
      transform-origin: center;
      transition: transform 0.25s ease;
    }

    canvas.zoomCrash {
      transform: scale(1.12);
    }

    canvas.nitroZoom {
      transform: scale(1.05);
      filter: brightness(1.08) contrast(1.15);
    }

    #controls {
      width: 100%;
      max-width: 420px;
      margin: 12px auto;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      padding: 0 12px;
      box-sizing: border-box;
    }

    .btn {
      flex: 1;
      height: 80px;
      border-radius: 18px;
      color: black;
      font-size: 34px;
      font-weight: 900;
      display: flex;
      justify-content: center;
      align-items: center;
      user-select: none;
      -webkit-user-select: none;
      -webkit-touch-callout: none;

      background: repeating-linear-gradient(
        45deg,
        #ffd500,
        #ffd500 12px,
        #111 12px,
        #111 24px
      );

      border: 3px solid #ffd500;
      box-shadow: 0 0 14px rgba(255,213,0,0.25);
      text-shadow: 0 0 6px rgba(0,0,0,0.8);
    }

    .btn:active {
      transform: scale(0.96);
      filter: brightness(1.2);
    }

    .nitroBtn {
      flex: 1.3;
      font-size: 20px;
      letter-spacing: 2px;
    }

    #startScreen {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.95);
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      text-align: center;
      z-index: 999;
      border-radius: 14px;
      overflow: hidden;
    }

    #introText {
      font-size: 16px;
      font-weight: 900;
      letter-spacing: 3px;
      color: #ffd500;
      opacity: 0;
      transform: translateY(20px);
      animation: introFade 1.5s ease forwards;
    }

    #mainLogo {
      font-size: 58px;
      margin: 12px 0 0 0;
      color: gold;
      letter-spacing: 8px;
      text-shadow: 0 0 25px rgba(255,215,0,0.35);
      opacity: 0;
      transform: scale(0.8);
      animation: logoPop 1.8s ease forwards;
      animation-delay: 1.2s;
    }

    #subText {
      margin-top: 10px;
      font-size: 14px;
      opacity: 0;
      animation: subFade 1.4s ease forwards;
      animation-delay: 2.5s;
    }

    #startBtn {
      margin-top: 26px;
      padding: 16px 32px;
      border: none;
      border-radius: 14px;
      font-size: 20px;
      cursor: pointer;
      background: repeating-linear-gradient(
        45deg,
        #ffd500,
        #ffd500 12px,
        #111 12px,
        #111 24px
      );
      color: black;
      font-weight: 900;
      box-shadow: 0 0 20px rgba(255,215,0,0.25);
      opacity: 0;
      pointer-events: none;
      animation: btnShow 1.2s ease forwards;
      animation-delay: 3.6s;
    }

    @keyframes introFade {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0px); }
    }

    @keyframes logoPop {
      0% { opacity: 0; transform: scale(0.75); }
      60% { opacity: 1; transform: scale(1.08); }
      100% { opacity: 1; transform: scale(1); }
    }

    @keyframes subFade {
      0% { opacity: 0; }
      100% { opacity: 0.85; }
    }

    @keyframes btnShow {
      0% { opacity: 0; transform: translateY(15px); }
      100% { opacity: 1; transform: translateY(0px); pointer-events: auto; }
    }

    #gameOver {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.88);
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      text-align: center;
      z-index: 999;
      border-radius: 14px;
    }

    #gameOver h1 {
      margin: 0;
      font-size: 42px;
      color: gold;
      text-shadow: 0 0 15px rgba(255,215,0,0.3);
    }

    #gameOver p {
      margin: 12px 0;
      opacity: 0.9;
    }

    button {
      padding: 12px 18px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      background: gold;
      font-weight: bold;
      box-shadow: 0 0 10px rgba(255,215,0,0.3);
    }
  </style>
</head>

<body>

<div id="hud">
  <div id="hudLeft">
    <div>Sk√≥re: <span id="score">0</span></div>
    <div id="shieldStatus">üõ°Ô∏è Shield: OFF</div>
  </div>

  <div id="hudRight">
    <div>Rychlost: <span id="speed">1</span>x</div>
    <div id="nitroBarWrap"><div id="nitroBar"></div></div>
  </div>
</div>

<div id="wrap">
  <canvas id="game"></canvas>

  <div id="startScreen">
    <div id="introText">DANIEL_SDILI UV√ÅD√ç:</div>
    <div id="mainLogo">ROADSTER</div>
    <div id="subText">Burnout Night Edition</div>
    <button id="startBtn">START</button>
  </div>

  <div id="gameOver">
    <h1>CRASHED!</h1>
    <p>Tvoje sk√≥re: <span id="finalScore">0</span></p>
    <button onclick="restartGame()">Zkusit znovu</button>
  </div>
</div>

<div id="controls">
  <div class="btn" id="leftBtn">‚óÄ</div>
  <div class="btn nitroBtn" id="nitroBtn">NITRO</div>
  <div class="btn" id="rightBtn">‚ñ∂</div>
</div>

<script>
  const canvas = document.getElementById("game");
  const ctx = canvas.getContext("2d");

  const scoreEl = document.getElementById("score");
  const speedEl = document.getElementById("speed");
  const nitroBar = document.getElementById("nitroBar");
  const shieldStatus = document.getElementById("shieldStatus");

  const gameOverScreen = document.getElementById("gameOver");
  const finalScoreEl = document.getElementById("finalScore");

  const startScreen = document.getElementById("startScreen");
  const startBtn = document.getElementById("startBtn");

  const leftBtn = document.getElementById("leftBtn");
  const rightBtn = document.getElementById("rightBtn");
  const nitroBtn = document.getElementById("nitroBtn");

  let w, h;

  function resizeCanvas() {
    const rect = canvas.getBoundingClientRect();
    canvas.width = rect.width * devicePixelRatio;
    canvas.height = rect.height * devicePixelRatio;
    ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, 0, 0);
    w = rect.width;
    h = rect.height;
  }

  window.addEventListener("resize", resizeCanvas);
  resizeCanvas();

  let score = 0;
  let baseSpeed = 5;
  let speed = baseSpeed;
  let frame = 0;

  let running = false;
  let crashed = false;
  let timeScale = 1;

  let holdingLeft = false;
  let holdingRight = false;

  let camShake = 0;

  let camTilt = 0;
  let targetTilt = 0;

  let debris = [];
  let billboards = [];

  let shieldActive = false;
  let shieldCooldown = 0;

  let nitroActive = false;
  let nitroTime = 0;
  let nitroCooldown = 0;

  const NITRO_MAX = 120;

  let powerUps = [];

  const player = {
    x: 0,
    y: 0,
    width: 62,
    height: 118,
    targetX: 0,
    angle: 0,
    spinVel: 0,
    lastX: 0
  };

  let laneLines = [];
  function resetRoad() {
    laneLines = [];
    for (let i = 0; i < 12; i++) {
      laneLines.push({ x: w/2, y: i * 90 });
    }
  }
  resetRoad();

  let enemies = [];
  let sparks = [];
  let smokes = [];
  let explosions = [];

  let tireDust = [];
  let skidMarks = [];
  let speedLines = [];

  function rand(min, max) {
    return Math.random() * (max - min) + min;
  }

  function spawnEnemy() {
    const types = ["sedan", "sport", "taxi", "police", "van", "truck"];
    const type = types[Math.floor(Math.random() * types.length)];

    let ew = 54, eh = 104;
    if (type === "police") { ew = 62; eh = 118; }
    if (type === "truck") { ew = 70; eh = 125; }
    if (type === "van") { ew = 64; eh = 120; }
    if (type === "sport") { ew = 60; eh = 102; }

    enemies.push({
      x: rand(40, w - 110),
      y: -200,
      width: ew,
      height: eh,
      type,
      angle: 0,
      crashed: false,
      spinVel: 0,
      vx: rand(-1.2, 1.2)
    });
  }

  function spawnBillboard() {
    const texts = ["ROADSTER", "DANIEL_SDILI", "NIGHT RUN", "BURNOUT STYLE", "POLICE ESCAPE", "NITRO ZONE"];
    const text = texts[Math.floor(Math.random() * texts.length)];

    const side = Math.random() > 0.5 ? "left" : "right";
    const x = side === "left" ? 8 : w - 128;

    billboards.push({
      x,
      y: -160,
      width: 120,
      height: 55,
      text,
      glow: rand(0.6, 1.0),
      life: 1000
    });
  }

  function updateBillboards() {
    billboards.forEach((b, idx) => {
      b.y += (speed + 2.2) * timeScale;
      b.life -= 1 * timeScale;
      if (b.y > h + 200 || b.life <= 0) billboards.splice(idx, 1);
    });
  }

  function drawBillboards() {
    billboards.forEach(b => {
      ctx.save();

      const pulse = 0.6 + Math.sin(frame * 0.12) * 0.35;
      const glow = pulse * b.glow;

      ctx.globalAlpha = 0.25 + glow * 0.25;
      ctx.fillStyle = "rgba(0,255,255,0.9)";
      ctx.fillRect(b.x - 8, b.y - 8, b.width + 16, b.height + 16);

      ctx.globalAlpha = 0.95;
      ctx.fillStyle = "rgba(0,0,0,0.85)";
      ctx.fillRect(b.x, b.y, b.width, b.height);

      ctx.globalAlpha = 1;
      ctx.strokeStyle = "rgba(0,255,255,0.8)";
      ctx.lineWidth = 2;
      ctx.strokeRect(b.x, b.y, b.width, b.height);

      ctx.font = "bold 14px Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillStyle = "rgba(0,255,255,0.95)";
      ctx.shadowColor = "rgba(0,255,255,0.8)";
      ctx.shadowBlur = 18;
      ctx.fillText(b.text, b.x + b.width/2, b.y + b.height/2);

      ctx.restore();
    });
  }

  function spawnDebris(x, y) {
    for (let i = 0; i < 26; i++) {
      debris.push({
        x,
        y,
        vx: rand(-18, 18),
        vy: rand(-18, 18),
        rot: rand(0, Math.PI * 2),
        rotVel: rand(-0.35, 0.35),
        size: rand(6, 18),
        life: rand(70, 150),
        color: ["#888", "#555", "#aaa", "#333"][Math.floor(Math.random()*4)]
      });
    }
  }

  function updateDebris() {
    debris.forEach((d, idx) => {
      d.life -= 1 * timeScale;
      d.x += d.vx * timeScale;
      d.y += d.vy * timeScale;
      d.vy += 0.35 * timeScale;
      d.rot += d.rotVel * timeScale;

      d.vx *= 0.985;
      d.vy *= 0.985;

      if (d.life <= 0) debris.splice(idx, 1);
    });
  }

  function drawDebris() {
    debris.forEach(d => {
      ctx.save();
      ctx.translate(d.x, d.y);
      ctx.rotate(d.rot);

      ctx.globalAlpha = Math.max(d.life / 150, 0) * 0.9;
      ctx.fillStyle = d.color;
      ctx.fillRect(-d.size/2, -d.size/2, d.size, d.size);

      ctx.globalAlpha *= 0.55;
      ctx.fillStyle = "rgba(255,255,255,0.8)";
      ctx.fillRect(-d.size/2, -d.size/2, d.size, 3);

      ctx.restore();
      ctx.globalAlpha = 1;
    });
  }

  function updateRoad() {
    laneLines.forEach(line => {
      line.y += speed * timeScale;
      if (line.y > h) line.y = -80;
    });
  }

  function drawRoadTexture() {
    const grad = ctx.createLinearGradient(0, 0, 0, h);
    grad.addColorStop(0, "#0b0b0f");
    grad.addColorStop(0.5, "#050508");
    grad.addColorStop(1, "#000000");

    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, w, h);

    ctx.globalAlpha = 0.12;
    const shine = ctx.createLinearGradient(0, 0, 0, h);
    shine.addColorStop(0, "rgba(255,255,255,0.0)");
    shine.addColorStop(0.4, "rgba(255,255,255,0.25)");
    shine.addColorStop(0.7, "rgba(255,255,255,0.05)");
    shine.addColorStop(1, "rgba(255,255,255,0.0)");
    ctx.fillStyle = shine;
    ctx.fillRect(w/2 - 90, 0, 180, h);
    ctx.globalAlpha = 1;

    ctx.globalAlpha = 0.10;
    for (let i = 0; i < 200; i++) {
      ctx.fillStyle = (Math.random() > 0.5)
        ? "rgba(255,255,255,0.15)"
        : "rgba(0,0,0,0.35)";
      ctx.fillRect(rand(0, w), rand(0, h), 1, 1);
    }
    ctx.globalAlpha = 1;

    ctx.globalAlpha = 0.38;
    ctx.fillStyle = "rgba(255,215,0,0.9)";
    ctx.fillRect(0, 0, 10, h);
    ctx.fillRect(w - 10, 0, 10, h);
    ctx.globalAlpha = 1;

    laneLines.forEach(line => {
      ctx.globalAlpha = 0.7;
      ctx.fillStyle = "rgba(255,255,255,0.7)";
      ctx.fillRect(line.x - 4, line.y, 8, 80);
      ctx.globalAlpha = 1;
    });
  }

  function updatePlayer() {
    if (!running) return;

    player.lastX = player.x;

    if (holdingLeft) player.targetX -= 7;
    if (holdingRight) player.targetX += 7;

    const minX = 20;
    const maxX = w - player.width - 20;

    if (player.targetX < minX) player.targetX = minX;
    if (player.targetX > maxX) player.targetX = maxX;

    player.x += (player.targetX - player.x) * 0.25;

    targetTilt = (player.targetX - player.x) * 0.0007;
    camTilt += (targetTilt - camTilt) * 0.12;
  }

  function updateEnemies() {
    enemies.forEach((e, idx) => {
      e.y += (speed + 1.2) * timeScale;
      e.x += e.vx * timeScale;

      if (e.y > h + 300) enemies.splice(idx, 1);
    });
  }

  function drawPlayer() {
    ctx.fillStyle = "red";
    ctx.fillRect(player.x, player.y, player.width, player.height);
  }

  function drawEnemies() {
    enemies.forEach(e => {
      ctx.fillStyle = "white";
      ctx.fillRect(e.x, e.y, e.width, e.height);
    });
  }

  function loop() {
    if (running) {
      frame++;

      updateRoad();
      updatePlayer();
      updateEnemies();
      updateDebris();
      updateBillboards();

      if (!crashed && frame % 70 === 0) spawnEnemy();
      if (!crashed && frame % 210 === 0) spawnBillboard();
    }

    ctx.save();

    ctx.translate(w/2, h/2);
    ctx.rotate(camTilt);
    ctx.translate(-w/2, -h/2);

    drawRoadTexture();
    drawBillboards();
    drawEnemies();
    drawPlayer();
    drawDebris();

    ctx.restore();

    requestAnimationFrame(loop);
  }

  player.x = w / 2 - player.width/2;
  player.targetX = player.x;
  player.y = h - 140;

  startBtn.addEventListener("click", () => {
    startScreen.style.display = "none";
    running = true;
  });

  leftBtn.addEventListener("touchstart", (e) => { e.preventDefault(); holdingLeft = true; });
  leftBtn.addEventListener("touchend", () => holdingLeft = false);

  rightBtn.addEventListener("touchstart", (e) => { e.preventDefault(); holdingRight = true; });
  rightBtn.addEventListener("touchend", () => holdingRight = false);

  window.addEventListener("keydown", (e) => {
    if (e.key === "ArrowLeft") holdingLeft = true;
    if (e.key === "ArrowRight") holdingRight = true;
  });

  window.addEventListener("keyup", (e) => {
    if (e.key === "ArrowLeft") holdingLeft = false;
    if (e.key === "ArrowRight") holdingRight = false;
  });

  requestAnimationFrame(loop);
</script>

</body>
</html>
